graph TD
    subgraph "Phase 1 & 2: Data Ingestion & Warehousing"
        A(OpenSky Network API) -->|1. GET /states/all| B;
        B -->|2. Process & Upsert Data| C[Fivetran Platform];
        C -->|3. Load Real-Time Data| D;
        E(Static CSV: maintenance_schedules) -->|Manual Upload| F;
    end

    subgraph "Phase 3 & 4: AI Agent & User Application"
        J["User (Logistics Manager)"] -->|4. Asks question via UI| K;
        K -->|5. Sends Query to Agent| G("Vertex AI Agent: 'AeroTrack AI'");
        G -- Invokes Tool --> I(Google Cloud Function);
        I -- Queries Data --> D & F;
        G -->|6. Synthesizes & Returns Response| K;
        K -->|7. Displays Predictive Alert| J;
    end

    style A fill:#D6EAF8
    style B fill:#F5B7B1
    style D fill:#D5F5E3
    style F fill:#D5F5E3
    style G fill:#FCF3CF
    style K fill:#EBDEF0
